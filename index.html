<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPARK-TAPAK KEKUATAN KAMI - PPD Miri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Menggunakan fon Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Kelas untuk menyembunyikan halaman yang tidak aktif */
        .page-content {
            display: none;
        }
        /* Kelas untuk memaparkan halaman yang aktif */
        .page-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        /* Kelas untuk pautan navigasi yang aktif */
        .nav-link.active {
            background-color: #f59e0b; /* Warna kuning (amber-500) */
            color: #1f2937; /* Warna kelabu (gray-800) */
        }
        
        /* Animasi Fade-in */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Memastikan fon Inter dimuatkan */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    </style>

    <script>
        // --- FUNGSI IKON (SVG) ---
        const iconEdit = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" /></svg>`;
        const iconDelete = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>`;
        const iconPlus = `<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>`;

        // --- FUNGSI BANTUAN UNTUK CIPTA SEL ---
        
        // Cipta sel input (untuk data-col)
        function createInputCell(type, value, dataCol) {
            return `<td class="p-2"><input type="${type}" class="w-full p-2 border rounded text-center" value="${value}" data-col="${dataCol}"></td>`;
        }

        // Cipta sel input catatan (khas)
        function createCatatanCell(value) {
            return `<td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" value="${value}" oninput="updateRedText(this)" ${document.getElementById('penyelaras-toggle')?.textContent.includes('Aktifkan') ? 'disabled' : ''}></td>`;
        }
        
        // Cipta sel butang tindakan (Edit/Padam)
        function createActionCell() {
            return `
            <td class="p-2 align-middle text-center">
                <button onclick="editRow(this)" class="text-blue-600 hover:text-blue-800 p-1 inline-block" title="Edit Nama">
                    ${iconEdit}
                </button>
                <button onclick="deleteRow(this)" class="text-red-600 hover:text-red-800 p-1 inline-block" title="Padam Baris">
                    ${iconDelete}
                </button>
            </td>`;
        }

        // --- FUNGSI TAMBAH BARIS (mengikut jenis jadual) ---

        // Untuk Aspek A4, A5, A6, A8 (Prasarana)
        // *** DIKEMASKINI untuk membuang baris "Tiada data" (cth: A8) ***
        window.addPrasaranaRow = function(tableId) {
            const newName = prompt("Masukkan nama prasarana baru:");
            if (!newName || newName.trim() === "") return;

            const tableBody = document.getElementById(tableId).querySelector('tbody');

            // --- BARU: Semak jika ada baris "Tiada data" dan buang ---
            const noDataRow = tableBody.querySelector('td[colspan]');
            if (noDataRow) {
                noDataRow.parentNode.remove(); // Buang <tr> yang mengandungi sel "Tiada data"
            }
            // --- TAMAT PERUBAHAN ---

            const newRow = tableBody.insertRow();
            newRow.innerHTML = `
                <td class="p-4"></td>
                <td class="p-4">${newName.trim()}</td>
                ${createInputCell('number', 0, 'ada')}
                ${createInputCell('number', 0, 'fungsi')}
                ${createInputCell('number', 0, 'perlu')}
                ${createCatatanCell('')}
                ${createActionCell()}
            `;
            window.reindexTable(tableBody);
        }

        // Untuk Aspek A7 (Peranti Digital)
        window.addPerantiRow = function(tableId) {
            const newName = prompt("Masukkan nama peranti baru:");
            if (!newName || newName.trim() === "") return;

            const tableBody = document.getElementById(tableId).querySelector('tbody');
            const newRow = tableBody.insertRow();
            newRow.innerHTML = `
                <td class="p-4"></td>
                <td class="p-4">${newName.trim()}</td>
                ${createInputCell('number', 0, 'ada')}
                ${createInputCell('number', 0, 'fungsi')}
                ${createCatatanCell('')}
                ${createActionCell()}
            `;
            window.reindexTable(tableBody);
        }

        // Untuk Aspek A9 - Jadual 1 (Program Ibu Bapa)
        window.addA91Row = function(tableId) {
            const newName = prompt("Masukkan nama program baru:");
            if (!newName || newName.trim() === "") return;

            const tableBody = document.getElementById(tableId).querySelector('tbody');
            const newRow = tableBody.insertRow();
            newRow.innerHTML = `
                <td class="p-4"></td>
                <td class="p-4">${newName.trim()}</td>
                ${createInputCell('text', 0, 'hadir')}
                ${createInputCell('text', 0, 'jumlah_ibubapa')}
                ${createInputCell('text', '0%', 'peratus_hadir')}
                ${createCatatanCell('')}
                ${createActionCell()}
            `;
            window.reindexTable(tableBody);
        }

        // Untuk Aspek A9 - Jadual 2 & 3 (Pelibatan PIBKS)
        window.addA923Row = function(tableId) {
            const newName = prompt("Masukkan nama pelibatan baru:");
            if (!newName || newName.trim() === "") return;

            const tableBody = document.getElementById(tableId).querySelector('tbody');
            const newRow = tableBody.insertRow();
            newRow.innerHTML = `
                <td class="p-4"></td>
                <td class="p-4">${newName.trim()}</td>
                ${createInputCell('number', 0, 'jumlah_terlibat')}
                ${createInputCell('text', '0%', 'peratus_terlibat')}
                ${createCatatanCell('')}
                ${createActionCell()}
            `;
            window.reindexTable(tableBody);
        }

        // --- FUNGSI UNTUK MENGURUS JADUAL SEDIA ADA (dipanggil pada DOMContentLoaded) ---
        function setupDynamicTables() {
            // Sasarkan semua jadual data (elak jadual lain jika ada)
            const allTables = document.querySelectorAll('table[id$="-table"], table[id^="aspek9-table-"]');

            allTables.forEach(table => {
                // 1. Tambah Pengepala "Tindakan"
                const headerRow = table.querySelector('thead tr');
                if (headerRow) {
                    const th = document.createElement('th');
                    th.className = "p-4 text-left text-sm font-semibold text-gray-600 uppercase";
                    th.textContent = 'Tindakan';
                    headerRow.appendChild(th);
                }

                // 2. Tambah Sel Tindakan (Butang) pada baris sedia ada
                const bodyRows = table.querySelectorAll('tbody tr');
                bodyRows.forEach(row => {
                    // Semak jika ini baris "Tiada data" di A8
                    const colspanCell = row.querySelector('td[colspan]');
                    if (colspanCell) {
                        // Tambah 1 pada colspan untuk lajur "Tindakan" baru
                        const currentColspan = parseInt(colspanCell.getAttribute('colspan')) || 0;
                        colspanCell.setAttribute('colspan', currentColspan + 1);
                        return; // Jangan tambah butang pada baris ini
                    }
                    // Cipta dan tambah sel tindakan
                    const td = document.createElement('td');
                    td.className = "p-2 align-middle text-center";
                    td.innerHTML = `
                        <button onclick="editRow(this)" class="text-blue-600 hover:text-blue-800 p-1 inline-block" title="Edit Nama">
                            ${iconEdit}
                        </button>
                        <button onclick="deleteRow(this)" class="text-red-600 hover:text-red-800 p-1 inline-block" title="Padam Baris">
                            ${iconDelete}
                        </button>
                    `;
                    row.appendChild(td);
                });
            });
        }
    </script>
</head>
<body class="bg-gray-100 font-inter text-gray-800">

    <div id="login-page" class="flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-800 to-blue-600 p-4">
        <div class="bg-white p-8 sm:p-12 rounded-xl shadow-2xl w-full max-w-md text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">SPARK-TAPAK KEKUATAN KAMI</h1>
            <p class="text-base text-gray-500 mb-6">Sistem Pelaporan dan Analisis Pejabat Pendidikan Daerah Miri</p>
            
            <div class="mb-4">
                <label for="school-code" class="sr-only">Kod Sekolah</label>
                <input type="text" id="school-code" placeholder="Masukkan Kod Sekolah Anda" class="w-full p-4 border border-gray-300 rounded-lg text-lg text-center focus:outline-none focus:ring-2 focus:ring-blue-500" />
            </div>
            
            <button id="login-button" class="w-full bg-blue-700 text-white p-4 rounded-lg text-lg font-semibold hover:bg-blue-800 transition duration-300 shadow-md">
                Log Masuk
            </button>
            
            <p id="login-error" class="text-red-600 text-sm mt-4 hidden">Kod sekolah tidak sah. Sila cuba lagi.</p>
        </div>
    </div>

    <div id="main-app" class="hidden flex flex-col min-h-screen">

        <header class="bg-blue-800 text-white shadow-md">
            <div class="container mx-auto px-4 py-6 flex flex-wrap justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold">SPARK-TAPAK KEKUATAN KAMI</h1>
                    <p class="text-lg text-blue-200">Sistem Pelaporan dan Analisis Pejabat Pendidikan Daerah Miri</p>
                </div>
                <div class="text-right mt-4 sm:mt-0">
                    <p class="text-sm text-blue-300">Log Masuk Sebagai:</p>
                    <p id="logged-in-school" class="text-lg font-semibold"></p>
                    <button id="penyelaras-toggle" class="mt-2 text-xs bg-yellow-400 text-gray-800 font-bold py-1 px-3 rounded-full hover:bg-yellow-300 transition duration-300">
                        Aktifkan Mod Penyelaras
                    </button>
                </div>
            </div>
        </header>

        <nav class="bg-gray-700 text-white sticky top-0 z-50 shadow-lg">
            <div class="container mx-auto px-4">
                <ul class="flex flex-wrap justify-center sm:justify-start">
                    <li><a href="#muka-depan" onclick="showPage('muka-depan')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Muka Depan</a></li>
                    <li><a href="#aspek4" onclick="showPage('aspek4')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A4</a></li>
                    <li><a href="#aspek5" onclick="showPage('aspek5')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A5</a></li>
                    <li><a href="#aspek6" onclick="showPage('aspek6')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A6</a></li>
                    <li><a href="#aspek7" onclick="showPage('aspek7')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A7</a></li>
                    <li><a href="#aspek8" onclick="showPage('aspek8')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A8</a></li>
                    <li><a href="#aspek9" onclick="showPage('aspek9')" class="nav-link p-4 inline-block font-semibold hover:bg-gray-600 transition duration-300">Aspek A9</a></li>
                    </ul>
            </div>
        </nav>

        <main class="container mx-auto p-4 md:p-6 flex-grow">

            <div id="muka-depan" class="page-content active">
                <div class="bg-white p-8 rounded-lg shadow-md text-center">
                    <h2 class="text-4xl font-bold text-blue-700 mb-4">TAPAK KEKUATAN KAMI</h2>
                    <p class="text-2xl text-gray-600 mb-8">TAHUN 2024</p>
                    <div class="text-lg space-y-2">
                        <p><strong>NAMA SEKOLAH:</strong> <strong data-id="nama-sekolah" class="font-normal">SJKC CHUNG HUA BAKAM</strong></p>
                        <p><strong>KOD SEKOLAH:</strong> <strong data-id="kod-sekolah" class="font-normal">YCC4105</strong></p>
                        </div>
                    <p class="mt-8 text-gray-500">Selamat datang ke laman SPARK. Sila gunakan menu navigasi di atas untuk meneroka setiap aspek.</p>
                </div>
            </div>

            <div id="aspek4" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-700">ASPEK A4: PRASARANA AKADEMIK</h2>
                        <button onclick="addPrasaranaRow('aspek4-table')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg inline-flex items-center transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah Baris
                        </button>
                    </div>
                    
                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek4-table">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PRASARANA AKADEMIK</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. SEDIA ADA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. BERFUNGSI</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. KEPERLUAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                    </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Bilik Aktiviti Kelas Agama/ Bilik Pendidikan Islam</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                    </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Bilik Darjah &lt; Daripada 750 kps / Kurang 3 bay</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="6" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="6" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="6" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">3</td>
                                    <td class="p-4">Bilik Darjah Pemulihan</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">4</td>
                                    <td class="p-4">Bilik Komputer</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">5</td>
                                    <td class="p-4">Bilik Muzik</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">6</td>
                                    <td class="p-4">Bilik RBT (Sekolah Rendah)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">7</td>
                                    <td class="p-4">Bilik Sains (Sekolah Rendah)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">8</td>
                                    <td class="p-4">Pusat Sumber/Perpustakaan</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="aspek5" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-700">ASPEK A5: PRASARANA SUKAN DAN KOKURIKULUM</h2>
                        <button onclick="addPrasaranaRow('aspek5-table')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg inline-flex items-center transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah Baris
                        </button>
                    </div>
                    
                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek5-table">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PRASARANA SUKAN DAN KOKURIKULUM</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. SEDIA ADA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. BERFUNGSI</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. KEPERLUAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Bilik Peralatan Sukan - Stor 1 Bay</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Gelanggang Serbaguna - Terbuka Berbumbung</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">3</td>
                                    <td class="p-4">Padang Sekolah - Keluasan Trek Kurang 200M</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="aspek6" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-700">ASPEK A6: PRASARANA HAL EHWAL MURID</h2>
                        <button onclick="addPrasaranaRow('aspek6-table')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg inline-flex items-center transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah Baris
                        </button>
                    </div>

                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek6-table">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PRASARANA HAL EHWAL MURID</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. SEDIA ADA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. BERFUNGSI</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. KEPERLUAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Bilik Operasi Skim Pinjaman Buku Teks Sekolah (BOSS)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Bilik Khas</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">3</td>
                                    <td class="p-4">Bilik Pengurusan Disiplin</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="1" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">4</td>
                                    <td class="p-4">Bilik Serbaguna</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="2" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">5</td>
                                    <td class="p-4">Ruang Serbaguna</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">6</td>
                                    <td class="p-4">Tandas Murid Lelaki</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="4" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">7</td>
                                    <td class="p-4">Tandas Murid Perempuan</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="11" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="11" data-col="fungsi"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="11" data-col="perlu"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="aspek7" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-700">ASPEK A7: PERSEKITARAN DIGITAL</h2>
                        <button onclick="addPerantiRow('aspek7-table')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg inline-flex items-center transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah Baris
                        </button>
                    </div>

                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek7-table">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PERANTI</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. SEDIA ADA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. BERFUNGSI</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Komputer (pengajaran dan pembelajaran)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="5" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="5" data-col="fungsi"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">NoteBook (pengajaran dan pembelajaran)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="41" data-col="ada"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="41" data-col="fungsi"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="aspek8" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-700">ASPEK A8: ASRAMA</h2>
                        <button onclick="addPrasaranaRow('aspek8-table')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg inline-flex items-center transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah Baris
                        </button>
                    </div>

                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek8-table">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PRASARANA ASRAMA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. SEDIA ADA</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. BERFUNGSI</th>
                                    <th class="p-2 text-left text-xs font-semibold text-gray-600 uppercase">BIL. KEPERLUAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td colspan="6" class="p-4 text-center text-gray-500">Tiada data prasarana asrama dilaporkan.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="aspek9" class="page-content">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h2 class="text-2xl font-bold mb-6 text-gray-700">ASPEK A9: SOKONGAN IBU BAPA/PENJAGA, KOMUNITI DAN PIHAK SWASTA</h2>
                    
                    <div class="flex justify-between items-center mt-6 mb-4">
                        <h3 class="text-xl font-semibold text-gray-600">Program Melibatkan Ibu Bapa</h3>
                        <button onclick="addA91Row('aspek9-table-1')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-3 rounded-lg inline-flex items-center transition duration-300 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah
                        </button>
                    </div>
                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek9-table-1">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">SENARAI PROGRAM</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BILANGAN KEHADIRAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BILANGAN IBU BAPA/PENJAGA</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">% KEHADIRAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Mesyuarat Agung PIBG</td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="-" data-col="hadir"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="-" data-col="jumlah_ibubapa"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="-" data-col="peratus_hadir"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Gotong Royong Perdana</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="56" data-col="hadir"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="58" data-col="jumlah_ibubapa"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="96.6%" data-col="peratus_hadir"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">3</td>
                                    <td class="p-4">Hari Terbuka/Hari Kad Laporan/Hari Bertemu Waris</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="58" data-col="hadir"></td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="58" data-col="jumlah_ibubapa"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="100%" data-col="peratus_hadir"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="flex justify-between items-center mt-8 mb-4">
                        <h3 class="text-xl font-semibold text-gray-600">Pelibatan Ibu Bapa dalam PIBKS</h3>
                        <button onclick="addA923Row('aspek9-table-2')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-3 rounded-lg inline-flex items-center transition duration-300 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah
                        </button>
                    </div>
                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek9-table-2">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">PELIBATAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BILANGAN IBU BAPA TERLIBAT</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">% PENGLIBATAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Sukarelawan dalam Kelas (SdK)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="56" data-col="jumlah_terlibat"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="100%" data-col="peratus_terlibat"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Penajaan/Sumbangan (material/bukan material)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="58" data-col="jumlah_terlibat"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="100%" data-col="peratus_terlibat"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="flex justify-between items-center mt-8 mb-4">
                        <h3 class="text-xl font-semibold text-gray-600">Pelibatan Komuniti dan Pihak Swasta dalam PIBKS</h3>
                        <button onclick="addA923Row('aspek9-table-3')" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-3 rounded-lg inline-flex items-center transition duration-300 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Tambah
                        </button>
                    </div>
                    <div class="rounded-lg border">
                        <table class="w-full min-w-max divide-y divide-gray-200" id="aspek9-table-3">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BIL.</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">PELIBATAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">BILANGAN KOMUNITI / PIHAK SWASTA TERLIBAT</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">% PENGLIBATAN</th>
                                    <th class="p-4 text-left text-sm font-semibold text-gray-600 uppercase">CATATAN (PENYELARAS DAERAH)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4">1</td>
                                    <td class="p-4">Sukarelawan dalam Kelas (SdK)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="10" data-col="jumlah_terlibat"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="100%" data-col="peratus_terlibat"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                                <tr>
                                    <td class="p-4">2</td>
                                    <td class="p-4">Penajaan/Sumbangan (material/bukan material)</td>
                                    <td class="p-2"><input type="number" class="w-full p-2 border rounded text-center" value="12" data-col="jumlah_terlibat"></td>
                                    <td class="p-2"><input type="text" class="w-full p-2 border rounded text-center" value="100%" data-col="peratus_terlibat"></td>
                                    <td class="p-2"><input type="text" class="catatan-input w-full p-2 border rounded" oninput="updateRedText(this)" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>

            </main>

        <footer class="bg-gray-800 text-gray-300 text-center p-6 mt-8">
            <p>Projek Inovasi oleh Pahan</p>
            <p class="mt-1 text-gray-400 text-sm">Versi 1.1 (2025)</p>
        </footer>
    
    </div> <script>
        // Fungsi untuk menukar halaman
        function showPage(pageId) {
            // Sembunyikan semua div kandungan halaman
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // Tunjukkan div kandungan halaman yang dipilih
            const activePage = document.getElementById(pageId);
            if (activePage) {
                activePage.classList.add('active');
            }

            // Panggilan ke populateKeseluruhan() dibuang

            // Kemas kini kelas 'active' pada pautan navigasi
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
                // Semak jika href pautan sepadan dengan pageId
                if (link.getAttribute('href') === '#' + pageId) {
                    link.classList.add('active');
                }
            });

            // Skrol ke bahagian atas halaman untuk pengalaman pengguna yang lebih baik
            window.scrollTo(0, 0);
        }

        // --- FUNGSI BARU UNTUK EDIT/PADAM/INDEKS ---
        
        /**
         * Mengira semula nombor BIL untuk jadual
         * @param {HTMLElement} tableBody - Elemen <tbody> jadual
         */
        window.reindexTable = function(tableBody) {
            if (!tableBody) return;
            const rows = tableBody.querySelectorAll('tr');
            rows.forEach((row, index) => {
                const firstCell = row.querySelector('td:first-child');
                // Pastikan ia bukan sel colspan (cth: "Tiada data")
                if (firstCell && !firstCell.hasAttribute('colspan')) {
                    firstCell.textContent = index + 1;
                }
            });
        }

        /**
         * Edit nama item pada baris (sel ke-2)
         * @param {HTMLElement} buttonEl - Butang edit yang ditekan
         */
        window.editRow = function(buttonEl) {
            const row = buttonEl.closest('tr');
            const nameCell = row.querySelector('td:nth-child(2)');
            if (!nameCell) return;
            
            const currentName = nameCell.textContent;
            const newName = prompt("Sila edit nama:", currentName);

            if (newName && newName.trim() !== "") {
                nameCell.textContent = newName.trim();
                // Tandakan item ini telah diubah (jika perlu)
                nameCell.classList.add('font-bold', 'text-blue-600'); 
            }
        }

        /**
         * Padam baris jadual
         * @param {HTMLElement} buttonEl - Butang padam yang ditekan
         */
        window.deleteRow = function(buttonEl) {
            if (!confirm("Anda pasti mahu padam baris ini?")) {
                return;
            }
            const row = buttonEl.closest('tr');
            const tableBody = row.parentNode; // Dapatkan <tbody>
            row.remove();
            window.reindexTable(tableBody); // Panggil reindex
        }


        // Logik utama DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- LOGIK LOG MASUK (BARU) ---
            const loginPage = document.getElementById('login-page');
            const mainApp = document.getElementById('main-app');
            const loginButton = document.getElementById('login-button');
            const schoolCodeInput = document.getElementById('school-code');
            const loginError = document.getElementById('login-error');
            const loggedInSchoolDisplay = document.getElementById('logged-in-school');

            // Kod sekolah yang sah (berdasarkan data anda)
            // Anda boleh menambah lebih banyak kod dalam array ini: const validCodes = ['YCC4105', 'YCC4106'];
            const validCodes = {
                'YCC4105': 'SJKC CHUNG HUA BAKAM'
                // Tambah kod dan nama sekolah lain di sini
            };

            // Fungsi untuk mengendalikan log masuk
            function handleLogin() {
                const enteredCode = schoolCodeInput.value.trim().toUpperCase();
                
                // Semak jika kod yang dimasukkan wujud dalam senarai validCodes
                if (Object.keys(validCodes).includes(enteredCode)) {
                    // Berjaya
                    loginPage.style.display = 'none'; // Sembunyikan halaman log masuk
                    mainApp.classList.remove('hidden'); // Paparkan aplikasi utama
                    
                    // Paparkan kod sekolah yang log masuk di header
                    loggedInSchoolDisplay.textContent = `${enteredCode} (${validCodes[enteredCode]})`;

                    // Tunjukkan halaman 'muka-depan' secara lalai selepas log masuk
                    showPage('muka-depan');

                    // **** PERUBAHAN DI SINI ****
                    // Memastikan elemen wujud sebelum menetapkan textContent
                    const namaSekolahElement = document.querySelector('#muka-depan strong[data-id="nama-sekolah"]');
                    const kodSekolahElement = document.querySelector('#muka-depan strong[data-id="kod-sekolah"]');

                    if (namaSekolahElement) {
                        namaSekolahElement.textContent = validCodes[enteredCode];
                    }
                    if (kodSekolahElement) {
                        kodSekolahElement.textContent = enteredCode;
                    }
                    // **** TAMAT PERUBAHAN ****

                    // --- BARU: Sediakan jadual dinamik SELEPAS log masuk ---
                    if (window.setupDynamicTables) {
                        window.setupDynamicTables();
                    }

                } else {
                    // Gagal
                    loginError.classList.remove('hidden'); // Paparkan mesej ralat
                }
            }

            // Tambah 'event listener' pada butang log masuk
            loginButton.addEventListener('click', handleLogin);
            
            // Benarkan log masuk dengan menekan 'Enter'
            schoolCodeInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });

            // --- BUTANG MOD PENYELARAS (BARU) ---
            const penyelarasButton = document.getElementById('penyelaras-toggle');
            if (penyelarasButton) {
                penyelarasButton.addEventListener('click', () => {
                    // Sasarkan SEMUA input catatan, termasuk yang ditambah secara dinamik
                    const inputs = document.querySelectorAll('.catatan-input'); 
                    const btn = document.getElementById('penyelaras-toggle');
                    
                    // Semak status (kita andaikan semua sama)
                    let isCurrentlyDisabled = false;
                    if (inputs.length > 0) {
                        // Perlu cari satu input yang mungkin wujud
                        const firstInput = document.querySelector('.catatan-input');
                        if (firstInput) {
                            isCurrentlyDisabled = firstInput.disabled;
                        }
                    }
                    
                    if (isCurrentlyDisabled) {
                        // Aktifkan Mod
                        inputs.forEach(input => input.disabled = false);
                        btn.textContent = 'Kunci Mod Penyelaras';
                        btn.classList.replace('bg-yellow-400', 'bg-red-500');
                        btn.classList.replace('text-gray-800', 'text-white');
                    } else {
                        // Kunci Mod
                        inputs.forEach(input => input.disabled = true);
                        btn.textContent = 'Aktifkan Mod Penyelaras';
                        btn.classList.replace('bg-red-500', 'bg-yellow-400');
                        btn.classList.replace('text-white', 'text-gray-800');
                    }
                });
            }


            // --- LOGIK PENGESAHAN (DIBUANG DARI HALAMAN KESELURUHAN) ---
            // Kod ini perlu dipindahkan ke halaman lain jika anda mahu fungsi hantar
            /*
            const submitButton = document.getElementById('submit-ppd-button');
            const confirmCheckbox = document.getElementById('pengesahan-checkbox');
            // ...
            */


            // --- FUNGSI BARU UNTUK CATATAN ---
            
            // Fungsi untuk mengemas kini warna teks berdasarkan input catatan
            window.updateRedText = function(inputEl) {
                if (!inputEl) return;
                const row = inputEl.closest('tr');
                if (!row) return;
                // Sasarkan sel kedua (Senarai Prasarana)
                const itemCell = row.querySelector('td:nth-child(2)');
                if (itemCell) {
                    if (inputEl.value.trim() !== '') {
                        itemCell.classList.add('text-red-600', 'font-bold');
                    } else {
                        itemCell.classList.remove('text-red-600', 'font-bold');
                    }
                }
            };

            // --- FUNGSI populateKeseluruhan DIBUANG ---


            // --- LOGIK NAVIGASI LAMA (Kini hanya berfungsi selepas log masuk) ---

            // Juga uruskan jika pengguna menavigasi menggunakan butang 'back'/'forward' pelayar
            window.onhashchange = () => {
                const pageId = window.location.hash.substring(1) || 'muka-de';
                showPage(pageId);
            };

            // Semak jika ada hash semasa muat halaman (cth: jika pautan dikongsi)
            // Ini tidak akan berfungsi sehingga selepas log masuk, tetapi ia ditetapkan untuk masa depan
            const initialPageId = window.location.hash.substring(1) || 'muka-depan';
            // Tunjukkan halaman 'muka-depan' secara lalai (dilaraskan daripada kod asal)
            // showPage('muka-depan') akan dipanggil selepas log masuk berjaya
        });
    </script>

</body>
</html>
